<!DOCTYPE html>
<html>
<head>
  <title>PWERM Debug Test</title>
</head>
<body>
  <h1>PWERM API Test</h1>
  <button onclick="testAPI()">Test PWERM API</button>
  <pre id="output"></pre>
  
  <script>
    async function testAPI() {
      const output = document.getElementById('output');
      output.textContent = 'Testing API...';
      
      try {
        const response = await fetch('/api/pwerm-analysis', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            company_name: 'Deel',
            current_arr: 500,
            growth_rate: 0.80,
            sector: 'SaaS-HR Tech'
          })
        });
        
        output.textContent = `Status: ${response.status} ${response.statusText}\n`;
        output.textContent += `Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}\n\n`;
        
        const text = await response.text();
        output.textContent += `Response length: ${text.length} bytes\n\n`;
        
        try {
          const data = JSON.parse(text);
          output.textContent += `Parsed successfully!\n`;
          output.textContent += `Keys: ${Object.keys(data).join(', ')}\n`;
          output.textContent += `Has summary: ${!!data.summary}\n`;
          output.textContent += `Has market_research: ${!!data.market_research}\n`;
          output.textContent += `Has scenarios: ${!!data.scenarios}\n`;
          if (data.scenarios) {
            output.textContent += `Scenarios count: ${data.scenarios.length}\n`;
          }
          if (data.summary) {
            output.textContent += `\nSummary:\n${JSON.stringify(data.summary, null, 2)}\n`;
          }
        } catch (e) {
          output.textContent += `Parse error: ${e.message}\n`;
          output.textContent += `First 1000 chars:\n${text.substring(0, 1000)}\n`;
        }
      } catch (error) {
        output.textContent = `Error: ${error.message}`;
      }
    }
  </script>
</body>
</html>