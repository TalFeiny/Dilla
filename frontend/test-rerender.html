<!DOCTYPE html>
<html>
<head>
    <title>Re-render Loop Test</title>
</head>
<body>
    <h1>Testing Management Accounts Page for Re-render Loop</h1>
    <iframe id="testFrame" src="http://localhost:3001/management-accounts" width="100%" height="600"></iframe>
    
    <div id="results" style="margin-top: 20px; padding: 20px; background: #f0f0f0;">
        <h2>Test Results:</h2>
        <p>Monitoring console for re-render loops...</p>
        <div id="renderCount">Render count: 0</div>
        <div id="errorCount">Errors: 0</div>
        <div id="status">Status: Testing...</div>
    </div>

    <script>
        let renderCount = 0;
        let errorCount = 0;
        let lastCheck = Date.now();
        
        // Monitor console for React errors
        const originalError = console.error;
        console.error = function(...args) {
            const errorMsg = args.join(' ');
            if (errorMsg.includes('Maximum update depth exceeded') || 
                errorMsg.includes('Too many re-renders')) {
                errorCount++;
                document.getElementById('errorCount').textContent = 'Errors: ' + errorCount;
                document.getElementById('status').textContent = 'Status: ❌ RE-RENDER LOOP DETECTED!';
                document.getElementById('status').style.color = 'red';
            }
            originalError.apply(console, args);
        };
        
        // Check after 5 seconds
        setTimeout(() => {
            if (errorCount === 0) {
                document.getElementById('status').textContent = 'Status: ✅ No re-render loop detected!';
                document.getElementById('status').style.color = 'green';
            }
        }, 5000);
        
        // Try to access the iframe content
        setTimeout(() => {
            try {
                const frame = document.getElementById('testFrame');
                if (frame && frame.contentWindow) {
                    console.log('Page loaded successfully');
                }
            } catch (e) {
                console.log('Cross-origin restrictions, but page is loading');
            }
        }, 2000);
    </script>
</body>
</html>