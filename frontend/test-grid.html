<!DOCTYPE html>
<html>
<head>
    <title>Grid API Test</title>
</head>
<body>
    <h1>Testing Grid API</h1>
    <button onclick="testGrid()">Test Grid API</button>
    <div id="result"></div>
    
    <iframe 
        id="app-frame"
        src="http://localhost:3001/management-accounts" 
        width="100%" 
        height="600"
        style="border: 1px solid #ccc; margin-top: 20px;">
    </iframe>
    
    <script>
        function testGrid() {
            const frame = document.getElementById('app-frame');
            const frameWindow = frame.contentWindow;
            
            const result = document.getElementById('result');
            
            if (frameWindow.grid) {
                result.innerHTML = '<p style="color: green;">✅ Grid API is available!</p>';
                console.log('Grid methods:', Object.keys(frameWindow.grid));
                
                // Test a simple write
                try {
                    frameWindow.grid.write("A1", "Test");
                    result.innerHTML += '<p style="color: green;">✅ Write command succeeded!</p>';
                } catch (e) {
                    result.innerHTML += '<p style="color: red;">❌ Write failed: ' + e + '</p>';
                }
            } else {
                result.innerHTML = '<p style="color: red;">❌ Grid API not found. Make sure the page is loaded.</p>';
            }
        }
        
        // Check every second
        setInterval(() => {
            const frame = document.getElementById('app-frame');
            if (frame && frame.contentWindow && frame.contentWindow.grid) {
                console.log('Grid API detected!');
            }
        }, 1000);
    </script>
</body>
</html>